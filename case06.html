<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case 06: 작업 지시서 전자화 | Technical Service Team</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="week-detail.css">
    <link rel="stylesheet" href="case-study.css">
</head>

<body>
    <nav class="week-nav">
        <a href="cases.html" class="nav-back"><i class="fas fa-arrow-left"></i> 사례 목록</a>
        <div class="week-indicator">
            <a href="case05.html" class="prev"><i class="fas fa-arrow-left"></i> Case 05</a>
            <span class="current case">Case 06</span>
            <a href="case07.html" class="next">Case 07 <i class="fas fa-arrow-right"></i></a>
        </div>
    </nav>

    <div class="case-study-banner ot-theme">
        <div class="container">
            <span class="case-badge"><i class="fas fa-industry"></i> Technical Service Team 실전 사례</span>
            <h2>Case 06: 작업 지시서 전자화</h2>
            <p>현장 작업자 모바일 작업 지시 시스템으로 종이 95% 감소</p>
        </div>
    </div>

    <section class="week-hero week8-theme">
        <div class="hero-content">
            <span class="week-badge">Case 06 | OT 전산화</span>
            <h1>📋 작업 지시서 전자화</h1>
            <p>SharePoint Lists와 Power Automate로 작업 지시 → 접수 → 완료 → 승인의 전 과정을 디지털화합니다</p>
            <div class="kpi-focus">
                <div class="kpi-item active"><i class="fas fa-file-alt"></i><span>종이 95%↓</span></div>
                <div class="kpi-item"><i class="fas fa-mobile-alt"></i><span>모바일 접수</span></div>
                <div class="kpi-item"><i class="fas fa-chart-bar"></i><span>실시간 현황</span></div>
            </div>
        </div>
    </section>

    <section class="sprint-goal">
        <div class="container">
            <div class="goal-card ot">
                <h2><i class="fas fa-exclamation-circle"></i> 문제 상황</h2>
                <div class="scenario-box">
                    <h4><i class="fas fa-users"></i> 현장의 목소리</h4>
                    <p>생산팀 정OO 반장이 작업 지시 프로세스의 문제점을 이야기합니다:<br>
                        <em>"매일 아침 20장 넘는 작업 지시서를 프린트해서 나눠줍니다.
                            작업자들이 완료하면 수기로 체크하고 사인 받아서 다시 사무실로 가져오는데,
                            이게 저녁때나 되어야 집계가 돼요. 긴급 변경사항 있으면 다시 프린트해서 뛰어다녀야 하고,
                            작업 완료율을 실시간으로 모르니까 진도 관리가 너무 어렵습니다."</em>
                    </p>
                </div>
                <div class="goal-metrics">
                    <div class="metric"><span class="metric-label">일일 작업지시</span><span class="metric-value">50건</span>
                    </div>
                    <div class="metric"><span class="metric-label">월간 종이량</span><span class="metric-value">1,000장</span>
                    </div>
                    <div class="metric"><span class="metric-label">개선 기간</span><span class="metric-value">4주</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="step-guide">
        <div class="container">
            <h2 class="section-title">📋 실행 가이드</h2>

            <!-- ===== STEP 1: 작업 지시 Lists ===== -->
            <div class="step-card" id="step1">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-tool sharepoint"><i class="fas fa-share-alt"></i><span>SharePoint Lists</span>
                    </div>
                    <span class="step-time"><i class="fas fa-clock"></i> Week 1 (월~화)</span>
                </div>
                <h3>"작업지시서" Lists 상세 구축</h3>
                <div class="step-content">
                    <div class="instructions">
                        <h4><i class="fas fa-list-ol"></i> 실행 순서</h4>

                        <div class="instruction-step">
                            <span class="instruction-num">1-1</span>
                            <div class="instruction-content">
                                <h5>Lists 생성</h5>
                                <div
                                    style="background: #f0fdf4; border-left: 4px solid #10b981; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>📍 생성 경로:</strong><br><br>
                                    <strong>방법 1 (Teams에서):</strong><br>
                                    Teams → 생산팀 채널 → 탭 "+" → Lists → "새 목록" → 이름: 작업지시서<br><br>
                                    <strong>방법 2 (SharePoint에서):</strong><br>
                                    SharePoint 사이트 → "+ 새로 만들기" → "목록" → 이름: 작업지시서<br><br>
                                    <span style="color: #047857;">💡 Teams에서 만들면 채널 탭에 바로 표시되어 접근성이 좋습니다.</span>
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">1-2</span>
                            <div class="instruction-content">
                                <h5>컬럼 구성 (총 16개)</h5>

                                <h6 style="margin-top: 1.5rem; color: #0078d4;">🔹 기본 정보</h6>
                                <table class="excel-table" style="font-size: 0.85rem;">
                                    <thead>
                                        <tr>
                                            <th>컬럼명</th>
                                            <th>유형</th>
                                            <th>상세 설정</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>지시번호</strong></td>
                                            <td>한 줄 텍스트</td>
                                            <td>자동생성 (WO-2025-0001 형식)<br>Power Automate에서 채번</td>
                                        </tr>
                                        <tr>
                                            <td><strong>작업명</strong></td>
                                            <td>한 줄 텍스트</td>
                                            <td>필수, 최대 100자<br>예: "라인1 컨베이어 벨트 교체"</td>
                                        </tr>
                                        <tr>
                                            <td><strong>작업구분</strong></td>
                                            <td>선택</td>
                                            <td>
                                                선택값:<br>
                                                • 정기점검 (녹색)<br>
                                                • 수리작업 (주황)<br>
                                                • 개선작업 (파랑)<br>
                                                • 설치작업 (보라)<br>
                                                • 긴급수리 (빨강)
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><strong>우선순위</strong></td>
                                            <td>선택</td>
                                            <td>
                                                선택값 (색상 포함):<br>
                                                • 🔴 긴급 (4시간 내)<br>
                                                • 🟠 높음 (당일)<br>
                                                • 🟡 보통 (3일 내)<br>
                                                • 🟢 낮음 (1주 내)
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h6 style="margin-top: 1.5rem; color: #10b981;">🔹 일정 및 위치</h6>
                                <table class="excel-table" style="font-size: 0.85rem;">
                                    <thead>
                                        <tr>
                                            <th>컬럼명</th>
                                            <th>유형</th>
                                            <th>상세 설정</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>계획시작일시</strong></td>
                                            <td>날짜 및 시간</td>
                                            <td>필수, 기본값: 오늘</td>
                                        </tr>
                                        <tr>
                                            <td><strong>계획완료일시</strong></td>
                                            <td>날짜 및 시간</td>
                                            <td>필수</td>
                                        </tr>
                                        <tr>
                                            <td><strong>실제시작일시</strong></td>
                                            <td>날짜 및 시간</td>
                                            <td>작업자가 "착수" 시 자동 입력</td>
                                        </tr>
                                        <tr>
                                            <td><strong>실제완료일시</strong></td>
                                            <td>날짜 및 시간</td>
                                            <td>작업자가 "완료" 시 자동 입력</td>
                                        </tr>
                                        <tr>
                                            <td><strong>작업장소</strong></td>
                                            <td>선택</td>
                                            <td>A동1층, A동2층, B동1층, B동2층, 옥외</td>
                                        </tr>
                                        <tr>
                                            <td><strong>설비</strong></td>
                                            <td>조회(Lookup)</td>
                                            <td>원본: 설비마스터 / 컬럼: 설비코드<br>+설비명 자동 표시</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h6 style="margin-top: 1.5rem; color: #f59e0b;">🔹 담당 및 상태</h6>
                                <table class="excel-table" style="font-size: 0.85rem;">
                                    <thead>
                                        <tr>
                                            <th>컬럼명</th>
                                            <th>유형</th>
                                            <th>상세 설정</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>지시자</strong></td>
                                            <td>사용자</td>
                                            <td>기본값: [Me] (작성자 자동 입력)</td>
                                        </tr>
                                        <tr>
                                            <td><strong>작업자</strong></td>
                                            <td>사용자</td>
                                            <td>복수 선택 허용 (팀 작업 시)</td>
                                        </tr>
                                        <tr>
                                            <td><strong>상태</strong></td>
                                            <td>선택</td>
                                            <td>
                                                선택값:<br>
                                                • 📝 작성중<br>
                                                • 📤 지시완료<br>
                                                • 👁️ 접수<br>
                                                • 🔧 진행중<br>
                                                • ✅ 완료<br>
                                                • ✔️ 승인<br>
                                                • ↩️ 반려
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h6 style="margin-top: 1.5rem; color: #8b5cf6;">🔹 상세 및 첨부</h6>
                                <table class="excel-table" style="font-size: 0.85rem;">
                                    <thead>
                                        <tr>
                                            <th>컬럼명</th>
                                            <th>유형</th>
                                            <th>상세 설정</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>작업내용</strong></td>
                                            <td>여러 줄 텍스트</td>
                                            <td>서식 있는 텍스트 사용 허용<br>단계별 작업 지시 상세</td>
                                        </tr>
                                        <tr>
                                            <td><strong>완료보고</strong></td>
                                            <td>여러 줄 텍스트</td>
                                            <td>작업자가 완료 시 작성</td>
                                        </tr>
                                        <tr>
                                            <td><strong>작업사진</strong></td>
                                            <td>이미지</td>
                                            <td>완료 후 사진 첨부<br>모바일 촬영 가능</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">1-3</span>
                            <div class="instruction-content">
                                <h5>"선택" 컬럼에 색상 설정하기</h5>
                                <div
                                    style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>📍 상태 컬럼 색상 설정:</strong><br><br>
                                    <strong>Step 1:</strong> Lists 상단 컬럼명 "상태" 클릭 → "열 설정" → "이 열 편집"<br>
                                    <strong>Step 2:</strong> 각 선택값 옆 색상 박스 클릭<br>
                                    <strong>Step 3:</strong> 원하는 색상 선택<br><br>
                                    <strong>권장 색상:</strong><br>
                                    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem;">
                                        <span
                                            style="background: #e5e7eb; padding: 0.25rem 0.5rem; border-radius: 4px;">📝
                                            작성중 (회색)</span>
                                        <span
                                            style="background: #dbeafe; padding: 0.25rem 0.5rem; border-radius: 4px;">📤
                                            지시완료 (파랑)</span>
                                        <span
                                            style="background: #fef3c7; padding: 0.25rem 0.5rem; border-radius: 4px;">👁️
                                            접수 (노랑)</span>
                                        <span
                                            style="background: #fed7aa; padding: 0.25rem 0.5rem; border-radius: 4px;">🔧
                                            진행중 (주황)</span>
                                        <span
                                            style="background: #d1fae5; padding: 0.25rem 0.5rem; border-radius: 4px;">✅
                                            완료 (녹색)</span>
                                        <span
                                            style="background: #a7f3d0; padding: 0.25rem 0.5rem; border-radius: 4px;">✔️
                                            승인 (진녹색)</span>
                                        <span
                                            style="background: #fecaca; padding: 0.25rem 0.5rem; border-radius: 4px;">↩️
                                            반려 (빨강)</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">1-4</span>
                            <div class="instruction-content">
                                <h5>뷰(View) 생성 - 역할별 맞춤</h5>
                                <table class="excel-table">
                                    <thead>
                                        <tr>
                                            <th>뷰 이름</th>
                                            <th>대상</th>
                                            <th>필터</th>
                                            <th>표시 컬럼</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>오늘 작업</td>
                                            <td>전체</td>
                                            <td>계획시작일시 = 오늘</td>
                                            <td>지시번호, 작업명, 작업자, 상태, 우선순위</td>
                                        </tr>
                                        <tr>
                                            <td>내 작업</td>
                                            <td>작업자</td>
                                            <td>작업자 = [Me]</td>
                                            <td>지시번호, 작업명, 상태, 계획완료일시</td>
                                        </tr>
                                        <tr>
                                            <td>승인 대기</td>
                                            <td>관리자</td>
                                            <td>상태 = 완료</td>
                                            <td>지시번호, 작업명, 작업자, 실제완료일시</td>
                                        </tr>
                                        <tr>
                                            <td>긴급 작업</td>
                                            <td>전체</td>
                                            <td>우선순위 = 긴급</td>
                                            <td>전체 컬럼</td>
                                        </tr>
                                        <tr>
                                            <td>지연 작업</td>
                                            <td>관리자</td>
                                            <td>계획완료일시 < 오늘 AND 상태 ≠ 완료,승인</td>
                                            <td>지시번호, 작업명, 작업자, 계획완료일시, 상태</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">1-5</span>
                            <div class="instruction-content">
                                <h5>뷰 필터 조건 상세 설정</h5>
                                <div
                                    style="background: #f0f9ff; border-left: 4px solid #0078d4; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>📍 "오늘 작업" 뷰 만들기:</strong><br><br>
                                    <strong>Step 1:</strong> Lists 우측 상단 뷰 드롭다운 → "새 보기 만들기"<br>
                                    <strong>Step 2:</strong> 보기 이름: "오늘 작업"<br>
                                    <strong>Step 3:</strong> "목록으로 표시" 선택<br>
                                    <strong>Step 4:</strong> "필터" 클릭 → 조건 추가:<br>
                                    <div
                                        style="background: white; padding: 1rem; margin: 0.5rem 0; border-radius: 4px; font-family: monospace;">
                                        계획시작일시 &nbsp; <strong>다음보다 크거나 같음</strong> &nbsp; [오늘]<br>
                                        <strong>AND</strong><br>
                                        계획시작일시 &nbsp; <strong>다음보다 작음</strong> &nbsp; [오늘+1]
                                    </div>
                                    <strong>Step 5:</strong> "열 표시/숨기기"에서 필요한 컬럼만 선택<br>
                                    <strong>Step 6:</strong> "저장"<br><br>
                                    <span style="color: #0078d4;">💡 [오늘], [Me] 등은 SharePoint 동적 값으로, 접속자/접속일에 따라 자동
                                        변경됩니다.</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tip-box">
                        💡 <strong>Tip:</strong> "내 작업" 뷰를 기본 뷰로 설정하면, 작업자가 접속 시 자신의 할 일만 바로 보입니다.
                        (뷰 설정 → "기본 보기로 설정" 체크)
                    </div>
                </div>
            </div>

            <!-- ===== STEP 2: Power Automate 워크플로우 ===== -->
            <div class="step-card" id="step2">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-tool powerautomate"><i class="fas fa-cog"></i><span>Power Automate</span></div>
                    <span class="step-time"><i class="fas fa-clock"></i> Week 1 (수~금)</span>
                </div>
                <h3>작업 지시 워크플로우 자동화 (4개 흐름)</h3>
                <div class="step-content">
                    <div class="instructions">
                        <h4><i class="fas fa-bolt"></i> 흐름 1: 지시번호 자동 생성</h4>

                        <div class="instruction-step">
                            <span class="instruction-num">2-1</span>
                            <div class="instruction-content">
                                <h5>흐름 전체 구조</h5>
                                <div style="background: #f8f9fa; padding: 2rem; border-radius: 12px;">
                                    <div
                                        style="display: flex; flex-direction: column; gap: 0.75rem; align-items: center;">
                                        <div
                                            style="background: #dbeafe; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>1️⃣ 트리거: 항목이 만들어질 때</strong><br>
                                            <small>목록: 작업지시서</small>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #fef3c7; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>2️⃣ 여러 항목 가져오기</strong><br>
                                            <small>올해 작업지시 중 최신 1건</small>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #d1fae5; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>3️⃣ 변수 초기화: NewWONumber</strong><br>
                                            <small>WO-2025-#### 형식 생성</small>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #e0e7ff; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>4️⃣ 항목 업데이트</strong><br>
                                            <small>지시번호 필드에 저장</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">2-2</span>
                            <div class="instruction-content">
                                <h5>자동채번 수식 (전체 코드)</h5>
                                <div
                                    style="background: #1e293b; color: #e2e8f0; padding: 1.5rem; border-radius: 8px; font-family: monospace; font-size: 0.85rem; overflow-x: auto;">
                                    <strong style="color: #60a5fa;">// 변수 초기화 - 값 필드에 아래 수식 입력</strong><br><br>
                                    concat(<br>
                                    &nbsp;&nbsp;'WO-',<br>
                                    &nbsp;&nbsp;formatDateTime(utcNow(), 'yyyy'),<br>
                                    &nbsp;&nbsp;'-',<br>
                                    &nbsp;&nbsp;if(<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;empty(body('여러_항목_가져오기')?['value']),<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;'0001',<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;formatNumber(<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add(<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int(<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;substring(<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first(body('여러_항목_가져오기')?['value'])?['지시번호'],<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8,<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'0000'<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;)<br>
                                    &nbsp;&nbsp;)<br>
                                    )<br><br>
                                    <strong style="color: #60a5fa;">// 결과 예시: WO-2025-0001, WO-2025-0002, ...</strong>
                                </div>
                            </div>
                        </div>

                        <h4 style="margin-top: 2.5rem;"><i class="fas fa-bolt"></i> 흐름 2: 작업 지시 알림</h4>

                        <div class="instruction-step">
                            <span class="instruction-num">2-3</span>
                            <div class="instruction-content">
                                <h5>지시 완료 시 작업자에게 Teams 알림</h5>
                                <div style="background: #f8f9fa; padding: 2rem; border-radius: 12px;">
                                    <div
                                        style="display: flex; flex-direction: column; gap: 0.75rem; align-items: center;">
                                        <div
                                            style="background: #dbeafe; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>트리거: 항목이 수정될 때</strong><br>
                                            <small>목록: 작업지시서</small>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #fef3c7; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>조건: 상태 = "지시완료"</strong>
                                        </div>
                                        <div style="display: flex; gap: 1rem; width: 85%;">
                                            <div style="flex: 1; text-align: center;">
                                                <div style="color: #10b981;">예 ↓</div>
                                                <div style="background: #d1fae5; padding: 1rem; border-radius: 8px;">
                                                    <strong>Teams 채팅 메시지</strong><br>
                                                    <small>작업자에게 1:1 알림</small>
                                                </div>
                                            </div>
                                            <div style="flex: 1; text-align: center;">
                                                <div style="color: #6b7280;">아니요 ↓</div>
                                                <div style="background: #e2e8f0; padding: 1rem; border-radius: 8px;">
                                                    종료
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">2-4</span>
                            <div class="instruction-content">
                                <h5>Teams 알림 메시지 작성</h5>
                                <div
                                    style="background: #1e293b; color: #e2e8f0; padding: 1.5rem; border-radius: 8px; font-family: monospace; font-size: 0.85rem;">
                                    <strong style="color: #60a5fa;">// "사용자와 채팅" 액션 설정</strong><br><br>
                                    <strong>받는 사람:</strong> @{triggerOutputs()?['body/작업자/Email']}<br><br>
                                    <strong>메시지:</strong><br>
                                    📋 <strong>새 작업이 배정되었습니다</strong><br><br>
                                    • 지시번호: @{triggerOutputs()?['body/지시번호']}<br>
                                    • 작업명: @{triggerOutputs()?['body/작업명']}<br>
                                    • 우선순위: @{triggerOutputs()?['body/우선순위/Value']}<br>
                                    • 완료기한: @{formatDateTime(triggerOutputs()?['body/계획완료일시'], 'yyyy-MM-dd HH:mm')}<br>
                                    • 작업장소: @{triggerOutputs()?['body/작업장소/Value']}<br><br>
                                    [작업 확인하기] 링크: @{triggerOutputs()?['body/{Link}']}
                                </div>
                            </div>
                        </div>

                        <h4 style="margin-top: 2.5rem;"><i class="fas fa-bolt"></i> 흐름 3: 작업 착수 시 시간 자동 기록</h4>

                        <div class="instruction-step">
                            <span class="instruction-num">2-5</span>
                            <div class="instruction-content">
                                <h5>상태 "진행중" 변경 시 실제시작일시 저장</h5>
                                <div style="background: #f8f9fa; padding: 2rem; border-radius: 12px;">
                                    <div
                                        style="display: flex; flex-direction: column; gap: 0.75rem; align-items: center;">
                                        <div
                                            style="background: #dbeafe; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>트리거: 항목이 수정될 때</strong>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #fef3c7; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>조건: 상태 = "진행중" AND 실제시작일시 = null</strong>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #d1fae5; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>항목 업데이트</strong><br>
                                            <small>실제시작일시 = utcNow()</small>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    style="background: #1e293b; color: #e2e8f0; padding: 1rem; border-radius: 8px; margin-top: 1rem; font-family: monospace; font-size: 0.85rem;">
                                    <strong style="color: #60a5fa;">// 조건 수식:</strong><br>
                                    @and(<br>
                                    &nbsp;&nbsp;equals(triggerOutputs()?['body/상태/Value'], '진행중'),<br>
                                    &nbsp;&nbsp;empty(triggerOutputs()?['body/실제시작일시'])<br>
                                    )
                                </div>
                            </div>
                        </div>

                        <h4 style="margin-top: 2.5rem;"><i class="fas fa-bolt"></i> 흐름 4: 완료 보고 → 승인 요청</h4>

                        <div class="instruction-step">
                            <span class="instruction-num">2-6</span>
                            <div class="instruction-content">
                                <h5>작업 완료 시 관리자에게 승인 요청</h5>
                                <div style="background: #f8f9fa; padding: 2rem; border-radius: 12px;">
                                    <div
                                        style="display: flex; flex-direction: column; gap: 0.75rem; align-items: center;">
                                        <div
                                            style="background: #dbeafe; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>트리거: 상태 = "완료"로 변경</strong>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #fef3c7; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>항목 업데이트: 실제완료일시 = now()</strong>
                                        </div>
                                        <div style="font-size: 1.5rem;">↓</div>
                                        <div
                                            style="background: #e0e7ff; padding: 1rem 2rem; border-radius: 8px; width: 85%; text-align: center;">
                                            <strong>승인 시작 및 대기 (Approvals)</strong><br>
                                            <small>지시자에게 승인 요청 전송</small>
                                        </div>
                                        <div style="display: flex; gap: 1rem; width: 85%;">
                                            <div style="flex: 1; text-align: center;">
                                                <div style="color: #10b981;">승인 ↓</div>
                                                <div style="background: #d1fae5; padding: 1rem; border-radius: 8px;">
                                                    상태 = "승인"
                                                </div>
                                            </div>
                                            <div style="flex: 1; text-align: center;">
                                                <div style="color: #ef4444;">거부 ↓</div>
                                                <div style="background: #fee2e2; padding: 1rem; border-radius: 8px;">
                                                    상태 = "반려"
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">2-7</span>
                            <div class="instruction-content">
                                <h5>"승인" 커넥터 사용 방법</h5>
                                <div
                                    style="background: #dbeafe; border-left: 4px solid #3b82f6; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>📍 승인 요청 설정:</strong><br><br>
                                    <strong>Step 1:</strong> "+ 새 단계" → 검색: "승인"<br>
                                    <strong>Step 2:</strong> "승인 시작 및 대기" 선택<br>
                                    <strong>Step 3:</strong> 승인 유형: "승인/거부 - 처음 응답"<br>
                                    <strong>Step 4:</strong> 제목: 작업 완료 승인 요청 - @{triggerOutputs()?['body/지시번호']}<br>
                                    <strong>Step 5:</strong> 할당 대상: @{triggerOutputs()?['body/지시자/Email']}<br>
                                    <strong>Step 6:</strong> 세부 정보:<br>
                                    <div
                                        style="background: white; padding: 0.75rem; margin: 0.5rem 0; border-radius: 4px; font-size: 0.85rem;">
                                        작업명: @{triggerOutputs()?['body/작업명']}<br>
                                        작업자: @{triggerOutputs()?['body/작업자/DisplayName']}<br>
                                        완료보고: @{triggerOutputs()?['body/완료보고']}
                                    </div>
                                    <strong>Step 7:</strong> 조건 추가: 결과 = "Approve" 또는 "Reject"에 따라 분기<br><br>
                                    <span style="color: #1d4ed8;">💡 승인자는 Teams 또는 Outlook에서 바로 승인/거부 가능</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tip-box">
                        💡 <strong>Tip:</strong> 흐름 4개가 많아 보이지만, 실제로는 비슷한 구조입니다.
                        먼저 1개를 완성하고 "다른 이름으로 저장"하여 복사 후 수정하면 빠릅니다.
                    </div>
                </div>
            </div>

            <!-- ===== STEP 3: 모바일 활용 ===== -->
            <div class="step-card" id="step3">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-tool teams"><i class="fab fa-microsoft"></i><span>Teams Mobile</span></div>
                    <span class="step-time"><i class="fas fa-clock"></i> Week 2 (월~화)</span>
                </div>
                <h3>현장 작업자 모바일 활용 교육</h3>
                <div class="step-content">
                    <div class="instructions">
                        <div class="instruction-step">
                            <span class="instruction-num">3-1</span>
                            <div class="instruction-content">
                                <h5>스마트폰에서 작업 접수하기</h5>
                                <div
                                    style="background: #f0fdf4; border-left: 4px solid #10b981; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>📱 작업자 워크플로우:</strong><br><br>
                                    <strong>1. 작업 확인</strong><br>
                                    Teams 앱 실행 → 알림 확인 → 링크 터치<br><br>
                                    <strong>2. 접수 처리</strong><br>
                                    Lists 항목 열기 → "편집" → 상태: "접수" 선택 → 저장<br><br>
                                    <strong>3. 착수 시</strong><br>
                                    상태: "진행중"으로 변경 → 저장<br>
                                    (자동으로 실제시작일시 기록됨)<br><br>
                                    <strong>4. 완료 시</strong><br>
                                    상태: "완료" 선택<br>
                                    완료보고 작성<br>
                                    작업사진 터치 → 카메라로 촬영 또는 갤러리 선택<br>
                                    저장<br><br>
                                    <span style="color: #047857;">✅ 전체 과정 1분 이내 완료!</span>
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">3-2</span>
                            <div class="instruction-content">
                                <h5>Microsoft Lists 앱 설치 (권장)</h5>
                                <div
                                    style="background: #dbeafe; border-left: 4px solid #3b82f6; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>📱 별도 앱의 장점:</strong><br><br>
                                    • Teams 앱보다 Lists 전용이라 더 빠름<br>
                                    • 오프라인에서도 열람 가능 (편집은 온라인 필요)<br>
                                    • 푸시 알림으로 변경사항 즉시 확인<br><br>
                                    <strong>설치:</strong><br>
                                    App Store / Play Store → "Microsoft Lists" 검색 → 설치 → 회사 계정 로그인
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">3-3</span>
                            <div class="instruction-content">
                                <h5>QR 코드로 빠른 접근</h5>
                                <div
                                    style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>💡 현장 게시용 QR 코드 생성:</strong><br><br>
                                    1. Lists URL 복사<br>
                                    2. QR 코드 생성 사이트 (예: qr-code-generator.com)<br>
                                    3. URL 붙여넣기 → QR 생성<br>
                                    4. 인쇄하여 현장 게시판에 부착<br><br>
                                    작업자가 스마트폰으로 QR 스캔 → 바로 Lists 접속
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== STEP 4: 관리자 현황판 ===== -->
            <div class="step-card" id="step4">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-tool excel"><i class="fas fa-table"></i><span>Excel / Power BI</span></div>
                    <span class="step-time"><i class="fas fa-clock"></i> Week 2 (수~금)</span>
                </div>
                <h3>실시간 작업 현황 대시보드</h3>
                <div class="step-content">
                    <div class="instructions">
                        <div class="instruction-step">
                            <span class="instruction-num">4-1</span>
                            <div class="instruction-content">
                                <h5>Excel에서 실시간 연결 피벗</h5>
                                <div
                                    style="background: #f0f9ff; border-left: 4px solid #0078d4; padding: 1.5rem; margin: 1rem 0; border-radius: 0 8px 8px 0;">
                                    <strong>📊 Excel 연결 방법:</strong><br><br>
                                    <strong>Step 1:</strong> Excel 열기 → 데이터 탭<br>
                                    <strong>Step 2:</strong> "데이터 가져오기" → "다른 원본에서" → "SharePoint 목록에서"<br>
                                    <strong>Step 3:</strong> 사이트 URL 입력<br>
                                    <strong>Step 4:</strong> "작업지시서" 목록 선택 → "로드"<br>
                                    <strong>Step 5:</strong> 피벗 테이블 삽입<br><br>
                                    <strong>권장 피벗 설정:</strong><br>
                                    • 행: 상태<br>
                                    • 값: 건수 (Count)<br>
                                    • 필터: 계획시작일시 = 오늘
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <span class="instruction-num">4-2</span>
                            <div class="instruction-content">
                                <h5>오늘 작업 현황 대시보드</h5>
                                <div class="dashboard-layout" style="grid-template-columns: repeat(5, 1fr);">
                                    <div class="dash-item" style="background: #e5e7eb;">
                                        <i class="fas fa-file-alt"></i>
                                        <h5>지시완료</h5>
                                        <span class="dash-value">8건</span>
                                    </div>
                                    <div class="dash-item" style="background: #fef3c7;">
                                        <i class="fas fa-eye"></i>
                                        <h5>접수</h5>
                                        <span class="dash-value">5건</span>
                                    </div>
                                    <div class="dash-item" style="background: #fed7aa;">
                                        <i class="fas fa-wrench"></i>
                                        <h5>진행중</h5>
                                        <span class="dash-value">12건</span>
                                    </div>
                                    <div class="dash-item success" style="background: #d1fae5;">
                                        <i class="fas fa-check"></i>
                                        <h5>완료</h5>
                                        <span class="dash-value">23건</span>
                                    </div>
                                    <div class="dash-item" style="background: #a7f3d0;">
                                        <i class="fas fa-check-double"></i>
                                        <h5>승인</h5>
                                        <span class="dash-value">18건</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== STEP 5: 운영 및 정착 ===== -->
            <div class="step-card" id="step5">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-tool teams"><i class="fab fa-microsoft"></i><span>Teams</span></div>
                    <span class="step-time"><i class="fas fa-clock"></i> Week 3-4</span>
                </div>
                <h3>운영 및 정착</h3>
                <div class="step-content">
                    <div class="standup-example">
                        <h4><i class="fas fa-comments"></i> 일일 스탠드업 활용</h4>
                        <div class="standup-person">
                            <strong>관리자: 현황 공유 (3분)</strong>
                            <ul>
                                <li>📊 대시보드 공유 (오늘 작업 현황)</li>
                                <li>🔴 지연 작업 확인 및 원인 파악</li>
                                <li>🆕 신규 긴급 작업 공지</li>
                            </ul>
                        </div>
                        <div class="standup-person">
                            <strong>작업자: 이슈 공유 (각 1분)</strong>
                            <ul>
                                <li>🔧 현재 진행 중인 작업</li>
                                <li>🚧 블로커 (부품 대기, 장비 필요 등)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="retro-board">
                        <div class="retro-column start">
                            <h4>✅ 시작할 것</h4>
                            <ul>
                                <li>긴급 작업 발생 시 즉시 Lists 등록</li>
                                <li>완료 시 사진 필수 첨부</li>
                            </ul>
                        </div>
                        <div class="retro-column stop">
                            <h4>🛑 멈출 것</h4>
                            <ul>
                                <li>종이 작업지시서 출력</li>
                                <li>구두 지시 후 기록 누락</li>
                            </ul>
                        </div>
                        <div class="retro-column continue">
                            <h4>🔄 계속할 것</h4>
                            <ul>
                                <li>모바일로 실시간 상태 업데이트</li>
                                <li>일일 현황 대시보드 공유</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="step-guide" style="background: #f0f9ff;">
        <div class="container">
            <h2 class="section-title">❓ 자주 묻는 질문 (FAQ)</h2>

            <div class="step-card">
                <h3><i class="fas fa-question-circle"></i> Q1. 승인 요청이 Teams에 안 와요</h3>
                <div class="step-content">
                    <div style="background: #d1fae5; padding: 1.5rem; border-radius: 8px;">
                        <strong>A:</strong> Power Automate 흐름 실행 기록을 확인하세요.<br><br>
                        <strong>확인:</strong> flow.microsoft.com → 해당 흐름 → 실행 기록 → 실패한 단계 확인<br><br>
                        <strong>일반적 원인:</strong><br>
                        • 지시자 이메일이 비어있음<br>
                        • 승인 커넥터 권한 누락 → 연결 재인증 필요
                    </div>
                </div>
            </div>

            <div class="step-card">
                <h3><i class="fas fa-question-circle"></i> Q2. 작업자가 실수로 다른 사람 작업을 수정했어요</h3>
                <div class="step-content">
                    <div style="background: #fef3c7; padding: 1.5rem; border-radius: 8px;">
                        <strong>A:</strong> Lists 권한을 항목 수준으로 제한할 수 있습니다.<br><br>
                        <strong>설정:</strong> Lists 설정 → 고급 설정 → "항목 편집" →
                        "사용자가 만든 항목만" 선택<br><br>
                        또는 Power Automate에서 작업자 검증 조건 추가
                    </div>
                </div>
            </div>

            <div class="step-card">
                <h3><i class="fas fa-question-circle"></i> Q3. 모바일에서 사진 업로드가 느려요</h3>
                <div class="step-content">
                    <div style="background: #dbeafe; padding: 1.5rem; border-radius: 8px;">
                        <strong>A:</strong> 사진 해상도를 낮추거나 Wi-Fi에서 업로드하세요.<br><br>
                        <strong>권장:</strong><br>
                        • 스마트폰 카메라 설정에서 해상도 "중간"으로<br>
                        • 또는 SharePoint 앱 대신 Microsoft Lists 앱 사용 (더 최적화됨)
                    </div>
                </div>
            </div>

            <div class="step-card">
                <h3><i class="fas fa-question-circle"></i> Q4. 과거 데이터는 어떻게 검색하나요?</h3>
                <div class="step-content">
                    <div style="background: #e0e7ff; padding: 1.5rem; border-radius: 8px;">
                        <strong>A:</strong> 뷰 필터 또는 검색 기능을 사용하세요.<br><br>
                        <strong>방법 1:</strong> 상단 검색창에 키워드 입력<br>
                        <strong>방법 2:</strong> "기간별 조회" 뷰 생성 (날짜 범위 필터)<br>
                        <strong>방법 3:</strong> Excel 연결 후 피벗으로 분석
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section class="week-summary">
        <div class="container">
            <div class="summary-card value-card">
                <h2><i class="fas fa-chart-line"></i> 개선 결과</h2>
                <div class="result-grid">
                    <div class="result-item"><i class="fas fa-file-alt"></i>
                        <h4>95%↓</h4>
                        <p>종이 감소</p>
                    </div>
                    <div class="result-item"><i class="fas fa-clock"></i>
                        <h4>실시간</h4>
                        <p>현황 파악</p>
                    </div>
                    <div class="result-item"><i class="fas fa-mobile"></i>
                        <h4>1분</h4>
                        <p>완료보고</p>
                    </div>
                    <div class="result-item"><i class="fas fa-check-double"></i>
                        <h4>자동화</h4>
                        <p>승인 프로세스</p>
                    </div>
                </div>
                <div class="value-metrics">
                    <div class="value-item">
                        <div class="value-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                            <i class="fas fa-clock"></i></div>
                        <div class="value-info">
                            <h4>관리 시간 절감</h4>
                            <p>지시서 출력/배포/회수/집계 시간 제거</p>
                            <span class="value-tag">일 2시간 → 30분 (75% 절감)</span>
                        </div>
                    </div>
                    <div class="value-item">
                        <div class="value-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                            <i class="fas fa-leaf"></i></div>
                        <div class="value-info">
                            <h4>종이 비용 절감</h4>
                            <p>월 1,000장 인쇄 비용 제거</p>
                            <span class="value-tag">연 50만원 절감 + 환경 기여</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="next-week-preview">
        <div class="container">
            <div class="preview-card case-preview ot">
                <span class="preview-label">다음 사례</span>
                <h2>Case 07: 안전 점검 체크리스트 앱</h2>
                <p>Microsoft Forms와 Power Automate로 일일 안전 점검 자동화</p>
                <a href="case07.html" class="btn btn-primary">다음 사례 보기 <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </section>

    <footer class="footer">
        <p>© 2025 Office 365 Agile Action Plan | <a href="cases.html">사례 목록</a> | <a href="index.html">전체 로드맵</a></p>
    </footer>
    <script src="script.js"></script>
</body>

</html>